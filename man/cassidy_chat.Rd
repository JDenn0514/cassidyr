% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/chat-console.R
\name{cassidy_chat}
\alias{cassidy_chat}
\title{Chat with CassidyAI (Unified Interface)}
\usage{
cassidy_chat(
  message,
  conversation = NULL,
  assistant_id = Sys.getenv("CASSIDY_ASSISTANT_ID"),
  api_key = Sys.getenv("CASSIDY_API_KEY"),
  context_level = c("standard", "minimal", "comprehensive"),
  include_data = TRUE,
  include_files = NULL,
  include_skills = NULL,
  timeout = 300,
  track_tokens = TRUE,
  warn_at = .CASSIDY_WARNING_AT,
  auto_compact = FALSE,
  thread_id = NULL,
  context = NULL
)
}
\arguments{
\item{message}{Character. The message to send to the assistant.}

\item{conversation}{Character or NULL. Controls conversation behavior:
\itemize{
\item \code{NULL} (default): Continue current conversation, or create new if none
\item \code{"new"}: Start a fresh conversation with new context
\item \code{conv_id} (string): Switch to and continue a specific conversation
}}

\item{assistant_id}{Character. The CassidyAI assistant ID. Defaults to
the \code{CASSIDY_ASSISTANT_ID} environment variable.}

\item{api_key}{Character. Your CassidyAI API key. Defaults to
the \code{CASSIDY_API_KEY} environment variable.}

\item{context_level}{Character. Amount of context to include for new
conversations: \code{"minimal"}, \code{"standard"} (default), or \code{"comprehensive"}.
See Details for what each level includes.}

\item{include_data}{Logical. Whether to include data frame descriptions
in context. Default is TRUE.}

\item{include_files}{Character vector. Optional file paths to include in
context for new conversations.}

\item{include_skills}{Character vector. Optional skill names to include
in context for new conversations.}

\item{timeout}{Numeric. Request timeout in seconds. Default is 300.}

\item{track_tokens}{Logical. Whether to track token usage and warn when
approaching limits. Default is TRUE.}

\item{warn_at}{Numeric. Fraction of token limit at which to warn about high
usage (default 0.80 = 80\%).}

\item{auto_compact}{Logical. Whether to automatically compact conversation
when approaching token limit. Default is FALSE to maintain console
simplicity. For long conversations with auto-compaction, use
\code{\link[=cassidy_session]{cassidy_session()}} instead.}

\item{thread_id}{Character or NULL. \strong{Deprecated.} For backward
compatibility only. If provided, uses legacy behavior without state
management.}

\item{context}{\strong{Deprecated.} For backward compatibility with session-based
chat only. Ignored when \code{thread_id} is provided.}
}
\value{
A \code{cassidy_chat} S3 object containing:
\describe{
\item{conversation_id}{Local conversation ID}
\item{thread_id}{Cassidy API thread ID}
\item{response}{The assistant's response (a \code{cassidy_response} object)}
\item{message}{Your original message}
\item{context_level}{Context level used (for new conversations)}
}
}
\description{
Send a message to a CassidyAI assistant with automatic conversation
management. This unified interface automatically continues conversations,
manages context, and persists chat history without requiring you to track
thread IDs or session objects.
}
\details{
\subsection{Context Levels}{
\itemize{
\item \strong{minimal}: Only project configuration (CASSIDY.md)
\item \strong{standard}: Config + session info + data descriptions (default)
\item \strong{comprehensive}: Config + session + git status + detailed data + files
}

Context is only gathered and sent for \strong{new conversations}, not when
continuing existing ones.
}

\subsection{Conversation Management}{

The package automatically tracks your current conversation in memory. Each
call to \code{cassidy_chat()} either continues the current conversation or starts
a new one based on the \code{conversation} parameter.

Conversations are automatically saved to disk after each message, so you can
resume them later even after restarting R.
}

\subsection{Token Management}{

By default, the function tracks token usage and warns when usage exceeds
80\% of the limit (200,000 tokens). This helps prevent API failures due to
token limit errors.

For long conversations, consider using \code{\link[=cassidy_session]{cassidy_session()}} which provides
automatic compaction when approaching token limits. Console chat keeps
\code{auto_compact = FALSE} by default to maintain simplicity.
}

\subsection{State Management Functions}{
\itemize{
\item \code{\link[=cassidy_conversations]{cassidy_conversations()}} - List saved conversations
\item \code{\link[=cassidy_current]{cassidy_current()}} - View current conversation info
\item \code{\link[=cassidy_reset]{cassidy_reset()}} - Clear package state and start fresh
}
}
}
\examples{
\dontrun{
# Simple usage - just chat!
cassidy_chat("What is the tidyverse?")
cassidy_chat("Tell me more")  # Automatically continues

# Start a new conversation
cassidy_chat("New topic", conversation = "new")

# Include specific files in context
cassidy_chat(
  "Review this code",
  conversation = "new",
  include_files = c("R/my-function.R")
)

# Use comprehensive context
cassidy_chat(
  "Help me understand this project",
  conversation = "new",
  context_level = "comprehensive"
)

# Check current conversation including token usage
cassidy_current()

# Token tracking warns when approaching limit
# (Happens automatically when usage > 80\%)
cassidy_chat("Continue our discussion")

# Disable token tracking if not needed
cassidy_chat("Quick question", track_tokens = FALSE)

# For long conversations with auto-compaction, use cassidy_session()
session <- cassidy_session(auto_compact = TRUE)
chat(session, "This will auto-compact when needed")

# Switch to a previous conversation
convs <- cassidy_conversations()
cassidy_chat("Continue where we left off", conversation = convs$id[2])

# Reset and start fresh
cassidy_reset()
cassidy_chat("Hello!")
}
}
\seealso{
Other chat-functions: 
\code{\link{cassidy_continue}()},
\code{\link{cassidy_conversations}()},
\code{\link{cassidy_current}()},
\code{\link{cassidy_reset}()},
\code{\link{cassidy_session}()},
\code{\link{cassidy_session_stats}()},
\code{\link{cassidy_write_code}()},
\code{\link{cassidy_write_file}()},
\code{\link{chat}()},
\code{\link{chat_text}()}
}
\concept{chat-functions}
